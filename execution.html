<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-execution">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.1">
<title data-rh="true">Execute Data Migration | SQL Migrator</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://jaimestill.github.io/sql-migrator/img/social-card.png"><meta data-rh="true" name="twitter:image" content="https://jaimestill.github.io/sql-migrator/img/social-card.png"><meta data-rh="true" property="og:url" content="https://jaimestill.github.io/sql-migrator/execution"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Execute Data Migration | SQL Migrator"><meta data-rh="true" name="description" content="Before performing the migration, you need to be sure that your environment is properly prepared. At the time of writing this documentation, my environment consists of the following:"><meta data-rh="true" property="og:description" content="Before performing the migration, you need to be sure that your environment is properly prepared. At the time of writing this documentation, my environment consists of the following:"><link data-rh="true" rel="icon" href="/sql-migrator/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://jaimestill.github.io/sql-migrator/execution"><link data-rh="true" rel="alternate" href="https://jaimestill.github.io/sql-migrator/execution" hreflang="en"><link data-rh="true" rel="alternate" href="https://jaimestill.github.io/sql-migrator/execution" hreflang="x-default"><link rel="stylesheet" href="/sql-migrator/assets/css/styles.8dddb8d5.css">
<link rel="preload" href="/sql-migrator/assets/js/runtime~main.268dbfa5.js" as="script">
<link rel="preload" href="/sql-migrator/assets/js/main.a77b6323.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function e(e){document.documentElement.setAttribute("data-theme",e)}var t=function(){var e=null;try{e=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(e){}return e}()||function(){var e=null;try{e=localStorage.getItem("theme")}catch(e){}return e}();null!==t?e(t):window.matchMedia("(prefers-color-scheme: dark)").matches?e("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,e("light"))}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/sql-migrator/"><div class="navbar__logo"><img src="/sql-migrator/img/logo.png" alt="Jaime Still" class="themedImage_ToTc themedImage--light_HNdA"><img src="/sql-migrator/img/logo.png" alt="Jaime Still" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">SQL Migrator</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/sql-migrator/">Docs</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/JaimeStill/sql-migrator" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/sql-migrator/">Home</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/sql-migrator/schema-design">Schema Design</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/sql-migrator/infrastructure">Migration Infrastructure</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/sql-migrator/cli">Migration CLI</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" href="/sql-migrator/execution">Execute Data Migration</a></li></ul></nav></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/sql-migrator/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Execute Data Migration</span><meta itemprop="position" content="1"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Execute Data Migration</h1></header><p>Before performing the migration, you need to be sure that your environment is properly prepared. At the time of writing this documentation, my environment consists of the following:</p><table><thead><tr><th>Tool</th><th>Version</th></tr></thead><tbody><tr><td><a href="https://dotnet.microsoft.com/en-us/download/dotnet/7.0" target="_blank" rel="noopener noreferrer">.NET SDK</a></td><td>7.0.306</td></tr><tr><td><a href="https://learn.microsoft.com/en-us/ef/core/cli/dotnet" target="_blank" rel="noopener noreferrer"><code>dotnet-ef</code></a></td><td>7.0.9</td></tr><tr><td><a href="https://www.microsoft.com/en-us/sql-server/sql-server-downloads" target="_blank" rel="noopener noreferrer">SQL Server</a></td><td>2022 Developer Edition</td></tr><tr><td><a href="https://learn.microsoft.com/en-us/sql/ssms/download-sql-server-management-studio-ssms?view=sql-server-ver16" target="_blank" rel="noopener noreferrer">SQL Server Management Studio</a></td><td>19.1</td></tr><tr><td><a href="https://learn.microsoft.com/en-us/sql/azure-data-studio/download-azure-data-studio?view=sql-server-ver16&amp;tabs=redhat-install%2Credhat-uninstall" target="_blank" rel="noopener noreferrer">Azure Data Studio</a></td><td>1.45.0</td></tr></tbody></table><p>Additionally, you should have access to a SQL Server with <a href="https://learn.microsoft.com/en-us/sql/samples/adventureworks-install-configure?view=sql-server-ver16&amp;tabs=ssms" target="_blank" rel="noopener noreferrer">AdventureWorks</a> installed.</p><p>The database configuration can be found in <a href="https://github.com/JaimeStill/sql-migrator/blob/main/src/Cli/connections.json" target="_blank" rel="noopener noreferrer">connections.json</a>:</p><div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">connections.json</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;Origin&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;Server&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;.\\DevSql&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;Database&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;AdventureWorks2022&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;Target&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;Server&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;.\\DevSql&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;Database&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;v2-schema&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;ConnectionStrings&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;Migration&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Server=.\\DevSql;Trusted_Connection=true;TrustServerCertificate=true;Database=v2-migration&quot;</span><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="theme-admonition theme-admonition-tip alert alert--success admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_S0QG"><p>If you need to consolidate multiple origin databases into a single target database, run the migration with different <code>connections.json</code> files where each <strong>origin</strong> database has a corresponding  <strong>origin</strong> <code>ConnectorConfig</code> and <strong>migration</strong> connection string.</p></div></div><p>The migration and target databases should always be in sync. If on of these databases is removed and you want to perform a new migration, the other database should also be removed prior to the migration.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="database-preparation">Database Preparation<a href="#database-preparation" class="hash-link" aria-label="Direct link to Database Preparation" title="Direct link to Database Preparation">​</a></h2><p>The migration and target databases have corresponding Entity Framework configuration in this project:</p><ul><li>Migration - <a href="https://github.com/JaimeStill/sql-migrator/blob/main/src/Core/Data/MigratorContext.cs" target="_blank" rel="noopener noreferrer">MigratorContext</a></li><li>Target - <a href="https://github.com/JaimeStill/sql-migrator/blob/main/src/App/Data/AppDbContext.cs" target="_blank" rel="noopener noreferrer">AppDbContext</a></li></ul><p>This project also defines tasks for dropping and updating these databases:</p><ul><li><a href="https://github.com/JaimeStill/sql-migrator/blob/main/.vscode/tasks.json#L5" target="_blank" rel="noopener noreferrer"><code>app-db-drop</code></a></li><li><a href="https://github.com/JaimeStill/sql-migrator/blob/main/.vscode/tasks.json#L19" target="_blank" rel="noopener noreferrer"><code>app-db-update</code></a></li><li><a href="https://github.com/JaimeStill/sql-migrator/blob/main/.vscode/tasks.json#L40" target="_blank" rel="noopener noreferrer"><code>migration-db-drop</code></a></li><li><a href="https://github.com/JaimeStill/sql-migrator/blob/main/.vscode/tasks.json#L54" target="_blank" rel="noopener noreferrer"><code>migration-db-update</code></a></li></ul><p>Alternatively, these commands can be executed from a terminal:</p><table><thead><tr><th>Task</th><th>Directory</th><th>Command</th></tr></thead><tbody><tr><td>Drop App DB</td><td><em>/src/App</em></td><td><code>dotnet ef database drop -f</code></td></tr><tr><td>Update App DB</td><td><em>/src/App</em></td><td><code>dotnet ef database update</code></td></tr><tr><td>Drop Migration DB</td><td><em>/src/Core</em></td><td><code>dotnet ef database drop -f</code></td></tr><tr><td>Update Migration DB</td><td><em>/src/Core</em></td><td><code>dotnet ef database update</code></td></tr></tbody></table><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_S0QG"><p>Each of the following section start off assuming that you are starting with a blank migration and target database. The CLI automatically initializes the migration database according to the connection string if it does not exist, so you only need to drop the database between CLI runs. The target database, however, does not and needs to be dropped and updated between CLI runs.</p><p>Additionally, all of the CLI runs are executed from the <code>/src/Cli/bin/Debug/net7.0/</code> directory after the project has been built.</p></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="migrate-a-single-entity">Migrate a Single Entity<a href="#migrate-a-single-entity" class="hash-link" aria-label="Direct link to Migrate a Single Entity" title="Direct link to Migrate a Single Entity">​</a></h2><p>The simplest form of data migration is to migrate a table that has no dependencies via its migration command. Doing so will only import the data from that specific table and nothing else.</p><p>To demonstrate this, run <code>.\migrator.exe migrate department</code>:</p><video controls=""><source src="https://github.com/JaimeStill/sql-migrator/assets/14102723/a2b59173-53fb-443c-bfd2-51583ea776e0"></video><p>Querying the target database, you can see that the <code>Department</code> records have been successfully migrated:</p><p><img loading="lazy" alt="Migrate Department" src="/sql-migrator/assets/images/migrate-department-002029b3dac01c70f699a686488f9353.png#gh-light-mode-only" width="1155" height="810" class="img_ev3q"><img loading="lazy" alt="Migrate Department" src="/sql-migrator/assets/images/migrate-department-df0ad0c53e0ef0e9ad83079de67e42ee.png#gh-dark-mode-only" width="1155" height="810" class="img_ev3q"></p><p>Additionally, querying the migration database, you can see that the recorded migration logs:</p><p><img loading="lazy" alt="Migrate Department Logs" src="/sql-migrator/assets/images/migrate-department-logs-3c42bcc103410b79138fb92da956ce7c.png#gh-light-mode-only" width="1155" height="810" class="img_ev3q"><img loading="lazy" alt="Migrate Department Logs" src="/sql-migrator/assets/images/migrate-department-logs-728bf2a768679264ee67261e2d433817.png#gh-dark-mode-only" width="1155" height="810" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="migrate-entities-recursively">Migrate Entities Recursively<a href="#migrate-entities-recursively" class="hash-link" aria-label="Direct link to Migrate Entities Recursively" title="Direct link to Migrate Entities Recursively">​</a></h2><p>If you&#x27;re performing a fresh migrating targeting a table with dependencies, the migrated data will include the records for the dependent data along with the targeted table records.</p><p>To demonstrate this, run <code>.\migrator.exe migrate employee</code>:</p><video controls=""><source src="https://github.com/JaimeStill/sql-migrator/assets/14102723/86c6b462-fb0b-4645-a5ef-5ac0561e4ba9"></video><p>Querying the target database, you can see that the <code>Employee</code> records have been migrated along with their dependent <code>Department</code> records:</p><p><img loading="lazy" alt="Migrate Recursive" src="/sql-migrator/assets/images/migrate-recursive-4839a132c0d34f0830e267b799e57a55.png#gh-light-mode-only" width="1155" height="810" class="img_ev3q"><img loading="lazy" alt="Migrate Recursive" src="/sql-migrator/assets/images/migrate-recursive-01f5739212fd6d7736e8ec17e4df172d.png#gh-dark-mode-only" width="1155" height="810" class="img_ev3q"></p><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_S0QG"><p>If <code>.\migrator.exe migrate contactinfo</code> had been run instead, all <code>ContactInfo</code> records would have also caused their dependent <code>Employee</code> records to be migrated as well as their dependent <code>Department</code> records.</p><p>By building in calls to <code>Translator.EnsureMigrated</code> for each dependency inside of an <code>OnMigrate</code> callback, we can ensure that the full dependency tree is migrated recursively.</p></div></div><p>Additionally, querying the migration database, you can see the recorded migration logs:</p><p><img loading="lazy" alt="Migrate Recursive Logs" src="/sql-migrator/assets/images/migrate-recursive-logs-a17ed5f706a301ce27b73fee2429b625.png#gh-light-mode-only" width="1155" height="810" class="img_ev3q"><img loading="lazy" alt="Migrate Recursive" src="/sql-migrator/assets/images/migrate-recursive-logs-be46a47f57dd05d45372407380b729b8.png#gh-dark-mode-only" width="1155" height="810" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="full-migration">Full Migration<a href="#full-migration" class="hash-link" aria-label="Direct link to Full Migration" title="Direct link to Full Migration">​</a></h2><p>Performing a full migration will execute the <code>Translator.Migrate()</code> migrations in the order they are specified in the <a href="https://github.com/JaimeStill/sql-migrator/blob/main/src/Cli/Commands/Migrate/FullCommand.cs" target="_blank" rel="noopener noreferrer"><code>FullCommand</code></a>.</p><p>To demonstrate this, run <code>.\migrator.exe migrate full</code>:</p><video controls=""><source src="https://github.com/JaimeStill/sql-migrator/assets/14102723/cd75c6bc-885f-47c8-9b6e-3d83c027e8cd"></video><p>Querying the target database, you can see that all records from all tables have been migrated:</p><p><img loading="lazy" alt="Migrate Full" src="/sql-migrator/assets/images/migrate-full-e413f3468cabec85d9ef44f096fb09a0.png#gh-light-mode-only" width="1155" height="810" class="img_ev3q"><img loading="lazy" alt="Migrate Full" src="/sql-migrator/assets/images/migrate-full-da35ecd00207a0fc5cc247a29deb895e.png#gh-dark-mode-only" width="1155" height="810" class="img_ev3q"></p><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_S0QG"><p>If data were ever migrated as a dependency before the migration for its table is executed, that record would be skipped during the validation phase since the record with that key would already be in the migration database. This ensures that there is no duplication of records polluting the migration.</p></div></div><p>Additionally, querying the migration database, you can see the recorded migration logs:</p><p><img loading="lazy" alt="Migrate Full Logs" src="/sql-migrator/assets/images/migrate-full-logs-5c214dbb1594fdec72810718995a5d1e.png#gh-light-mode-only" width="1155" height="810" class="img_ev3q"><img loading="lazy" alt="Migrate Full Logs" src="/sql-migrator/assets/images/migrate-full-logs-96e6efd715058ec54b8083a78cdb9a8e.png#gh-dark-mode-only" width="1155" height="810" class="img_ev3q"></p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/sql-migrator/cli"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Migration CLI</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#database-preparation" class="table-of-contents__link toc-highlight">Database Preparation</a></li><li><a href="#migrate-a-single-entity" class="table-of-contents__link toc-highlight">Migrate a Single Entity</a></li><li><a href="#migrate-entities-recursively" class="table-of-contents__link toc-highlight">Migrate Entities Recursively</a></li><li><a href="#full-migration" class="table-of-contents__link toc-highlight">Full Migration</a></li></ul></div></div></div></div></main></div></div></div>
<script src="/sql-migrator/assets/js/runtime~main.268dbfa5.js"></script>
<script src="/sql-migrator/assets/js/main.a77b6323.js"></script>
</body>
</html>